unit BaseModel;



interface

uses Generics.Collections,RTTI,Atributos,ServerData;

type
  TBaseModel = class(TObject)
  public
  function IndexColumns:TObjectList<TServerData>;
  end;


implementation
{ TBaseModel }

function TBaseModel.IndexColumns: TObjectList<TServerData>;
var
  Contexto: TRttiContext;
  Tipo: TRttiType;
  Propriedade: TRttiProperty;
  Atributo: TCustomAttribute;
  ConsultaSQL, CamposSQL, ValoresSQL: String;
  UltimoID:Integer;
  i:integer;
  Data:TServerData;
begin
    result := TObjectList<TServerData>.Create;
    Contexto := TRttiContext.Create;
    try
    Tipo := Contexto.GetType(self.ClassType);

    //preenche os nomes dos campos e valores
    for Propriedade in Tipo.GetProperties do
    begin
      for Atributo in Propriedade.GetAttributes do
      begin
        if Atributo is TIndexColumn then
        begin
          Data:=TServerData.Create;
          Data.Key := (Atributo as TIndexColumn).Name;
          Data.Value := (Atributo as TIndexColumn).Display);
          result.Add(Data);
          i := i + 1;
        end;
      end;
    end;
    finally
      Contexto.Free;
    end;
end;

end.
